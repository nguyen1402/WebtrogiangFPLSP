// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace FPLSP.Pages.LessonUPPages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using FPLSP;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using FPLSP.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using MudBlazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using FPLSP.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Blazored.Typeahead;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using CurrieTechnologies.Razor.SweetAlert2;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
using FPLSP.Repositories.Interfaces;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
using FPLSP.Server.Domain.Entities.CoresParts;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
using FPLSP.Server.Infrastructure.ViewModels.LessonContentUP;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
using FPLSP.Server.Infrastructure.ViewModels.LessonUP;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
using FPLSP.Server.Infrastructure.ViewModels.ResourceLinkUP;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
           [Authorize(Roles = "AdminCore,AdminCS")]

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/lessonUPCreate/{idsubjectUP}")]
    public partial class LessonUPCreate : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 15 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\LessonUPPages\LessonUPCreate.razor"
       
    [Inject] ILessonUPRepo _LessonUPRepo { get; set; }
    [Inject] ILessonContentUPRepo _lessonContentUPRepo { get; set; }

    [Inject] private IResourceLinkUPRepo _ResourceLinkUPRepo { get; set; }
    [Inject] private ISubjectUPRepo _subjectUPRepo { get; set; }
    [Inject] NavigationManager NavigationManager { get; set; }


    private List<LessonContentCP> _lstLessonContentCPs = new List<LessonContentCP>();
    private List<LessonCP> _lstLessonCPs = new List<LessonCP>();
    private List<LessonUPViewModel> _lstLessonUPViewModels = new List<LessonUPViewModel>();
    private List<ResourceLinkUPViewModel> _lstresourceLinkUPViewModels = new List<ResourceLinkUPViewModel>();
    private List<ResourceLink> _lstResourceLinkCPDtos = new List<ResourceLink>();


    private List<ResourceLinkUPViewModel> _lstResourceLinkUPs = new List<ResourceLinkUPViewModel>();

    private List<LessonContentUPViewModel> _lstLessonContentUPs = new List<LessonContentUPViewModel>();

    [Parameter]
    public string idsubjectUP { get; set; }
    [CascadingParameter]
    private Error Error { get; set; }
    public string status { get; set; } = "";

    private LessonUPCreateRequest request = new LessonUPCreateRequest();
    private LessonContentUPCreateRequest lessonContentUPCreate = new LessonContentUPCreateRequest();
    private ResourceLinkUPCreateRequest resourceLinkUPCreate = new ResourceLinkUPCreateRequest();
    private LessonContentUPListSearch _LessonContentUPSearch = new LessonContentUPListSearch();


    protected override async Task OnInitializedAsync()
    {
        await GetTasks();
    }

    private async Task GetTasks()
    {
        try
        {
            _lstLessonContentCPs = await _LessonUPRepo.GetAllLessonContentCP();
            _lstLessonCPs = await _LessonUPRepo.GetAllLessonCP();
            _lstLessonUPViewModels = await _LessonUPRepo.GetAll();
            _lstResourceLinkCPDtos = await _LessonUPRepo.GetAllResourceLinkCP();
            _lstresourceLinkUPViewModels = await _ResourceLinkUPRepo.GetAll();


            var pagingResponse = await _lessonContentUPRepo.GetList(_LessonContentUPSearch);
            _lstLessonContentUPs = pagingResponse.Items;
        }
        catch (Exception ex)
        {
            Error.ProcessError(ex);
        }
    }
    private async Task CreateSubmit()
    {
        try
        {
            var lstLessonUPByIDSubject = _lstLessonCPs.Where(c => c.SubjectId == Guid.Parse(idsubjectUP));

            foreach (var x in lstLessonUPByIDSubject)
            {
                if (_lstLessonUPViewModels.Any(c => c.Id == x.Id))
                {
                    continue;
                }
                request = new LessonUPCreateRequest()
                    {
                        SubjectId = x.SubjectId,
                        Descriptions = x.Descriptions,
                        LessonCode = x.LessonCode,
                        LessonName = x.LessonName,
                        Status = x.Status,
                        IsCompleted = false,
                        Id = x.Id
                    };

                await _LessonUPRepo.Create(request);
            }
            foreach (var item in _lstResourceLinkCPDtos)
            {
                if (_lstResourceLinkUPs.Any(c => c.Id == item.Id))
                {
                    continue;
                }
                if (_lstresourceLinkUPViewModels.All(c => c.Id != item.Id))
                {
                    resourceLinkUPCreate = new ResourceLinkUPCreateRequest()
                        {
                            Descriptions = item.Descriptions,
                            Path = item.Path,
                            Id = item.Id,
                            ResourcesTitle = item.Descriptions,
                            Status = item.Status
                        };
                    await _ResourceLinkUPRepo.Create(resourceLinkUPCreate);
                }
            }
            _lstLessonUPViewModels = await _LessonUPRepo.GetAll();
            foreach (var x in _lstLessonContentCPs)
            {
                if (_lstLessonContentUPs.Any(c => c.Id == x.Id))
                {
                    continue;
                }
                if (_lstLessonUPViewModels.Any(c => c.Id == x.IdLesson))
                {
                    lessonContentUPCreate = new LessonContentUPCreateRequest()
                        {
                            Content = x.Content,
                            Descriptions = x.Descriptions,
                            Id = x.Id,
                            LessonContentCode = x.LessonContentCode,
                            LessonContentName = x.LessonContentName,
                            LessonId = x.IdLesson,
                            ResuorceLinkId = x.ResourceLinkId,
                            Status = x.Status
                        };
                    await _lessonContentUPRepo.Create(lessonContentUPCreate);
                }
            }


            //request.Status = Convert.ToInt32(status);
            //request.SubjectId = Guid.Parse(idsubjectUP);
            //var result = await _LessonUPRepo.Create(request);

            NavigationManager.NavigateTo($"/lessonUP/{idsubjectUP}");

        }
        catch (Exception ex)
        {
            Error.ProcessError(ex);
        }
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
