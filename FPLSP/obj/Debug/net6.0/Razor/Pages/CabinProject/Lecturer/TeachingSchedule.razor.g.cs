#pragma checksum "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "25569d6daaa774fa43ca8b2bba2305c9c054ff05"
// <auto-generated/>
#pragma warning disable 1591
namespace FPLSP.Pages.CabinProject.Lecturer
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using FPLSP;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using FPLSP.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using MudBlazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using Blazored.Typeahead;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\_Imports.razor"
using CurrieTechnologies.Razor.SweetAlert2;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using System.Text;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using System.Text.RegularExpressions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using System.Diagnostics;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using Blazored.Toast.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Components.CabinProject;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Data.Securities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Repositories.Interfaces.CabinProject;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Repositories.Interfaces;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Server.Infrastructure.ViewModels.CabinProject.BookingCabin;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Server.Infrastructure.ViewModels.CabinProject.ShiftOfCabin;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Server.Infrastructure.ViewModels;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using FPLSP.Server.Infrastructure.ViewModels.CabinProject.TeachingSchedule;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
using Microsoft.AspNetCore.SignalR.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
           [Authorize(Roles = "Lecturer")]

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/Cabin/lecturer/{idUserNonDecrypt}")]
    public partial class TeachingSchedule : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css\" rel=\"stylesheet\" b-ym1ctbmkn4>\r\n\r\n");
            __builder.OpenElement(1, "body");
            __builder.AddAttribute(2, "b-ym1ctbmkn4");
#nullable restore
#line 23 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
     if (listShift == null || listFullShift == null || listSchedule == null)
    {

#line default
#line hidden
#nullable disable
            __builder.OpenComponent<global::FPLSP.Components.LoadingIndicator>(3);
            __builder.CloseComponent();
#nullable restore
#line 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
    }
    else
    {
        

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
         if (listFullShift.Count() == 0 || listSchedule.Count() == 0)
        {

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(4, "<h3 b-ym1ctbmkn4>Hiện chưa có lịch dạy online</h3>");
#nullable restore
#line 32 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
        }
        else
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(5, "div");
            __builder.AddAttribute(6, "class", "modal-header");
            __builder.AddAttribute(7, "b-ym1ctbmkn4");
            __builder.OpenElement(8, "h3");
            __builder.AddAttribute(9, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(10, "Lịch cabin ");
#nullable restore
#line (36,33)-(36,75) 25 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(11, daysOfWeek[0].Item2.ToString("dd/MM/yyyy"));

#line default
#line hidden
#nullable disable
            __builder.AddContent(12, "-");
#nullable restore
#line (36,77)-(36,140) 25 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(13, daysOfWeek[daysOfWeek.Count() - 1].Item2.ToString("dd/MM/yyyy"));

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(14, " (Kì ");
#nullable restore
#line (36,146)-(36,158) 25 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(15, semesterName);

#line default
#line hidden
#nullable disable
            __builder.AddContent(16, "-");
#nullable restore
#line (36,160)-(36,169) 25 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(17, blockName);

#line default
#line hidden
#nullable disable
            __builder.AddContent(18, ")");
            __builder.CloseElement();
            __builder.AddMarkupContent(19, "\r\n                ");
            __builder.OpenElement(20, "button");
            __builder.AddAttribute(21, "type", "button");
            __builder.AddAttribute(22, "class", "close");
            __builder.AddAttribute(23, "data-dismiss", "modal");
            __builder.AddAttribute(24, "aria-label", "Close");
            __builder.AddAttribute(25, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 38 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                          () => ViewBookingRequest()

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(26, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(27, "<div style=\"color: #ff5f00;\" b-ym1ctbmkn4><h6 b-ym1ctbmkn4>Thông báo</h6>\r\n                        <h3 style=\"margin: 0;\" b-ym1ctbmkn4><i class=\"fa-regular fa-bell\" b-ym1ctbmkn4></i></h3></div>");
            __builder.CloseElement();
            __builder.AddMarkupContent(28, "\r\n                ");
            __builder.OpenComponent<global::FPLSP.Components.CabinProject.BookingRequestForLecturerPage>(29);
            __builder.AddAttribute(30, "ConfirmationTitle", "Thông Báo");
            __builder.AddAttribute(31, "IdLecturer", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.String>(
#nullable restore
#line 48 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                    idUser.ToString()

#line default
#line hidden
#nullable disable
            ));
            __builder.AddComponentReferenceCapture(32, (__value) => {
#nullable restore
#line 49 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                             bookingRequestForLecturer = (FPLSP.Components.CabinProject.BookingRequestForLecturerPage)__value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(33, "\r\n            ");
            __builder.OpenElement(34, "div");
            __builder.AddAttribute(35, "class", "notification-modal-div py-3");
            __builder.AddAttribute(36, "style", "display:" + " " + (
#nullable restore
#line 52 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                      close

#line default
#line hidden
#nullable disable
            ) + ";");
            __builder.AddAttribute(37, "b-ym1ctbmkn4");
            __builder.OpenElement(38, "button");
            __builder.AddAttribute(39, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 53 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                   Close

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(40, "style", "float:right;border: 0; margin: 0 10px;");
            __builder.AddAttribute(41, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(42, "✖️");
            __builder.CloseElement();
            __builder.AddMarkupContent(43, "\r\n                ");
            __builder.AddMarkupContent(44, "<h4 style=\"padding-left: 50px;\" b-ym1ctbmkn4>Chụp ảnh xác nhận</h4>\r\n                ");
            __builder.OpenElement(45, "div");
            __builder.AddAttribute(46, "hidden", 
#nullable restore
#line 55 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                              loadCamera

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(47, "b-ym1ctbmkn4");
            __builder.OpenElement(48, "img");
            __builder.AddAttribute(49, "hidden", 
#nullable restore
#line 56 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                  viewImage

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(50, "src", 
#nullable restore
#line 56 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                   image

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(51, "style", "width: 380px;height: 270px; margin: 0 5px;");
            __builder.AddAttribute(52, "alt", "Alternate Text");
            __builder.AddAttribute(53, "b-ym1ctbmkn4");
            __builder.CloseElement();
            __builder.AddMarkupContent(54, "\r\n                    ");
            __builder.OpenElement(55, "button");
            __builder.AddAttribute(56, "hidden", 
#nullable restore
#line 57 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                     viewImage

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(57, "class", "btn btn-secondary mx-3 my-3");
            __builder.AddAttribute(58, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 57 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                                              ComeBack

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(59, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(60, "Chụp lại");
            __builder.CloseElement();
            __builder.AddMarkupContent(61, "\r\n                    ");
            __builder.OpenElement(62, "div");
            __builder.AddAttribute(63, "hidden", 
#nullable restore
#line 58 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                  viewCamera

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(64, "style", "margin:0 auto;");
            __builder.AddAttribute(65, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(66, "<div b-ym1ctbmkn4><div id=\"camera-cabin\" b-ym1ctbmkn4></div></div>");
            __builder.CloseElement();
            __builder.AddMarkupContent(67, "\r\n                    ");
            __builder.OpenElement(68, "button");
            __builder.AddAttribute(69, "hidden", 
#nullable restore
#line 64 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                     viewCamera

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(70, "class", "btn btn-secondary mx-3 my-3");
            __builder.AddAttribute(71, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 64 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                                               Capture

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(72, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(73, "Chụp ảnh");
            __builder.CloseElement();
            __builder.AddMarkupContent(74, "\r\n                    ");
            __builder.OpenElement(75, "button");
            __builder.AddAttribute(76, "class", "btn btn-success mx-3 my-3");
            __builder.AddAttribute(77, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 65 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                        Submit

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(78, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(79, "Xác nhận");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(80, "\r\n\r\n                ");
            __builder.OpenElement(81, "div");
            __builder.AddAttribute(82, "style", "background-color:aliceblue;");
            __builder.AddAttribute(83, "b-ym1ctbmkn4");
            __builder.OpenComponent<global::FPLSP.Components.CabinProject.ConfirmCheckInCamera>(84);
            __builder.AddAttribute(85, "ConfirmationMessage", "Bạn muốn thoát chụp xác nhận?");
            __builder.AddAttribute(86, "ConfirmationTitle", "Chụp xác nhận");
            __builder.AddAttribute(87, "ConfirmationChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::Microsoft.AspNetCore.Components.EventCallback<global::System.Boolean>>(global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::System.Boolean>(this, 
#nullable restore
#line 71 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                       OnConfirmationClose

#line default
#line hidden
#nullable disable
            )));
            __builder.AddComponentReferenceCapture(88, (__value) => {
#nullable restore
#line 71 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                                  Confirmclose = (FPLSP.Components.CabinProject.ConfirmCheckInCamera)__value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(89, "\r\n            ");
            __builder.OpenElement(90, "div");
            __builder.AddAttribute(91, "class", "table-container");
            __builder.AddAttribute(92, "b-ym1ctbmkn4");
            __builder.OpenElement(93, "table");
            __builder.AddAttribute(94, "b-ym1ctbmkn4");
            __builder.OpenElement(95, "thead");
            __builder.AddAttribute(96, "b-ym1ctbmkn4");
            __builder.OpenElement(97, "tr");
            __builder.AddAttribute(98, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(99, "<th style=\"text-align: center!important;\" b-ym1ctbmkn4></th>");
#nullable restore
#line 79 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                             foreach (var item in daysOfWeek)
                            {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(100, "th");
            __builder.AddAttribute(101, "style", "text-align: center!important;");
            __builder.AddAttribute(102, "b-ym1ctbmkn4");
#nullable restore
#line (81,76)-(81,86) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(103, item.Item1);

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(104, "<br b-ym1ctbmkn4>");
            __builder.OpenElement(105, "small");
            __builder.AddAttribute(106, "b-ym1ctbmkn4");
#nullable restore
#line (81,98)-(81,131) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(107, item.Item2.ToString("dd/MM/yyyy"));

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 82 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(108, "\r\n                    ");
            __builder.OpenElement(109, "tbody");
            __builder.AddAttribute(110, "b-ym1ctbmkn4");
#nullable restore
#line 86 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                         foreach (var shift in listShift.OrderBy(c => c.IndexOfShift))
                        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(111, "tr");
            __builder.AddAttribute(112, "b-ym1ctbmkn4");
            __builder.OpenElement(113, "td");
            __builder.AddAttribute(114, "class", "shift");
            __builder.AddAttribute(115, "b-ym1ctbmkn4");
#nullable restore
#line (89,52)-(89,67) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(116, shift.ShiftName);

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(117, "<br b-ym1ctbmkn4>");
            __builder.OpenElement(118, "small");
            __builder.AddAttribute(119, "b-ym1ctbmkn4");
#nullable restore
#line (89,79)-(89,114) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(120, shift.StartTime.ToString(@"hh\:mm"));

#line default
#line hidden
#nullable disable
            __builder.AddContent(121, "-");
#nullable restore
#line (89,116)-(89,149) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(122, shift.EndTime.ToString(@"hh\:mm"));

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 90 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                 foreach (var day in daysOfWeek.Select(c => c.Item2).ToList())
                                {

                                    

#line default
#line hidden
#nullable disable
#nullable restore
#line 93 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                     if (listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day) != null)
                                    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(123, "td");
            __builder.AddAttribute(124, "class", 
#nullable restore
#line 95 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                     new DateTime(day.Year,day.Month,day.Day,shift.StartTime.Hours,shift.StartTime.Minutes,shift.StartTime.Seconds) <= DateTime.Now && DateTime.Now < new DateTime(day.Year,day.Month,day.Day,shift.EndTime.Hours,shift.EndTime.Minutes,shift.EndTime.Seconds) ? "today-schedule" : ""

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(125, "b-ym1ctbmkn4");
            __builder.OpenElement(126, "div");
            __builder.AddAttribute(127, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 96 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                             () => BookARoom(listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day))

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(128, "b-ym1ctbmkn4");
#nullable restore
#line 97 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                 if (listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdCabin != null)
                                                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(129, "div");
            __builder.AddAttribute(130, "b-ym1ctbmkn4");
            __builder.OpenElement(131, "div");
            __builder.AddAttribute(132, "b-ym1ctbmkn4");
#nullable restore
#line 101 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                             if (listBookingCabin.FirstOrDefault(c => c.IdShift == shift.Id
                                                           && c.ClassId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdClass
                                                           && c.SubjectId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdSubject
                                                           && c.IdLectuter == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdLecturer
                                                           && c.DateCreated == new DateTime(listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Year, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Month, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Day)) != null)
                                                            {
                                                                

#line default
#line hidden
#nullable disable
#nullable restore
#line 107 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                 if (listBookingCabin.FirstOrDefault(c => c.IdShift == shift.Id
                                                               && c.ClassId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdClass
                                                               && c.SubjectId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdSubject
                                                               && c.IdLectuter == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdLecturer
                                                               && c.DateCreated == new DateTime(listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Year, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Month, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Day)).CheckinImage != null)
                                                                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(133, "small");
            __builder.AddAttribute(134, "style", "float:left; font-size: 9px;");
            __builder.AddAttribute(135, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(136, "<i class=\"fas fa-check-circle\" style=\"margin: 0 3px; color: greenyellow;\" b-ym1ctbmkn4></i>\r\n                                                                        ");
            __builder.OpenElement(137, "img");
            __builder.AddAttribute(138, "src", 
#nullable restore
#line 115 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                                    Encoding.ASCII.GetString(listBookingCabin.FirstOrDefault(c => c.DateCreated == new DateTime(listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Year, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Month, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).TeachingDay.Value.Day) && c.IdShift == shift.Id && c.ClassId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdClass && c.SubjectId == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdSubject && c.IdLectuter == listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).IdLecturer).CheckinImage)

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(139, "style", "width:16px;height:16px; object-fit:cover;");
            __builder.AddAttribute(140, "b-ym1ctbmkn4");
            __builder.CloseElement();
            __builder.AddMarkupContent(141, "\r\n                                                                        Đã CheckIn\r\n                                                                    ");
            __builder.CloseElement();
#nullable restore
#line 119 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                }

#line default
#line hidden
#nullable disable
#nullable restore
#line 119 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                                 
                                                            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(142, "\r\n                                                        ");
            __builder.OpenElement(143, "div");
            __builder.AddAttribute(144, "b-ym1ctbmkn4");
            __builder.OpenElement(145, "small");
            __builder.AddAttribute(146, "style", "float:right; font-size: 9px;");
            __builder.AddAttribute(147, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(148, "<i class=\"fas fa-circle\" style=\"margin: 0 3px; color: greenyellow;\" b-ym1ctbmkn4></i>");
#nullable restore
#line (124,138)-(124,235) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(149, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).CabinName);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 128 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                }
                                                else
                                                {

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(150, "<small style=\"float:right; font-size: 9px;\" b-ym1ctbmkn4><i class=\"far fa-circle\" style=\"margin: 0 3px; color: red;\" b-ym1ctbmkn4></i>Chờ xếp phòng\r\n                                                    </small>");
#nullable restore
#line 134 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                }

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(151, "<br b-ym1ctbmkn4>Lớp: ");
#nullable restore
#line (136,59)-(136,156) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(152, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).ClassName);

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(153, "\r\n                                                <br b-ym1ctbmkn4>Môn: ");
#nullable restore
#line (137,59)-(137,158) 26 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
__builder.AddContent(154, listFullShift.FirstOrDefault(c => c.IdShiftOfCabin == shift.Id && c.TeachingDay == day).SubjectCode);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 140 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                    }
                                    else
                                    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(155, "td");
            __builder.AddAttribute(156, "class", 
#nullable restore
#line 143 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                                     new DateTime(day.Year,day.Month,day.Day,shift.StartTime.Hours,shift.StartTime.Minutes,shift.StartTime.Seconds) <= DateTime.Now && DateTime.Now < new DateTime(day.Year,day.Month,day.Day,shift.EndTime.Hours,shift.EndTime.Minutes,shift.EndTime.Seconds) ? "today-schedule" : ""

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(157, "style", "background-color: #f9fafb63;");
            __builder.AddAttribute(158, "b-ym1ctbmkn4");
            __builder.AddMarkupContent(159, "<p style=\"text-align: center!important;\" b-ym1ctbmkn4>TRỐNG</p>");
            __builder.CloseElement();
#nullable restore
#line 146 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                    }

#line default
#line hidden
#nullable disable
#nullable restore
#line 146 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                     

                                }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 150 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(160, "\r\n            <div class=\"py-2\" b-ym1ctbmkn4></div>\r\n            ");
            __builder.OpenComponent<global::FPLSP.Components.CabinProject.DetailShift>(161);
            __builder.AddAttribute(162, "ConfirmationMessage", "Chi Tiết Ca Dạy");
            __builder.AddAttribute(163, "ConfirmationTitle", "Xác Nhận");
            __builder.AddAttribute(164, "IdClass", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Guid>(
#nullable restore
#line 157 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                          IdClassForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(165, "IdSubject", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Guid>(
#nullable restore
#line 158 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                            IdSubjectForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(166, "IdLecturer", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Guid>(
#nullable restore
#line 159 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                             IdLecturerForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(167, "IdShift", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Guid>(
#nullable restore
#line 160 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                          IdShiftForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(168, "IdCabin", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Guid?>(
#nullable restore
#line 161 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                          IdCabinForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(169, "ClassSubjectName", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.String>(
#nullable restore
#line 162 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                   ClassSubjectNameForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(170, "LecturerName", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.String>(
#nullable restore
#line 163 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                               LecturerNameForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(171, "ShiftName", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.String>(
#nullable restore
#line 164 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                            ShiftNameForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(172, "CabinName", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.String>(
#nullable restore
#line 165 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                            CabinNameForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(173, "TeachingDay", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.DateTime>(
#nullable restore
#line 166 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                              TeachingDayForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(174, "StartShift", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.TimeSpan>(
#nullable restore
#line 167 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                             StartShiftForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(175, "EndShift", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.TimeSpan>(
#nullable restore
#line 168 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                           EndShiftForDetails

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(176, "ConfirmationChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::Microsoft.AspNetCore.Components.EventCallback<global::System.Int32>>(global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::System.Int32>(this, 
#nullable restore
#line 170 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                                      OnConfirmationBooking

#line default
#line hidden
#nullable disable
            )));
            __builder.AddComponentReferenceCapture(177, (__value) => {
#nullable restore
#line 169 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
                       bookingCabin = (FPLSP.Components.CabinProject.DetailShift)__value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.CloseComponent();
#nullable restore
#line 172 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 172 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
         
    }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 177 "C:\Users\Nguyen Bui\source\repos\FPLSP3\FPLSP\Pages\CabinProject\Lecturer\TeachingSchedule.razor"
       
    [Parameter]
    public string idUserNonDecrypt { get; set; }
    public string idUser { get; set; }
    [Inject] public CryptoServices _cryptoServices { get; set; }
    [Inject] ITaskRepositories<ClassUPViewModel> subjectClassRepo { get; set; }
    [Inject] ITeachingScheduleApiClient teachingScheduleApiClient { get; set; }
    [Inject] public IBookingCabinApiClient _bookingCabinApiClient { get; set; }
    [Inject] IShiftOfCabinApiClient shiftOfCabinApiClient { get; set; }
    [Inject] IBlockRepo blockRepo { get; set; }
    [Inject] ISemesterRepo semesterRepo { get; set; }
    [Inject] private IToastService _toastService { get; set; }

    protected DetailShift bookingCabin { set; get; }
    protected BookingRequestForLecturerPage bookingRequestForLecturer { set; get; }

    private string image = "";
    private string close = "none";//dùng đóng mở tab chụp ảnh
    private bool loadCamera;
    private byte[] byteimage;//biến đế lưu ảnh theo kiểu byte
    private bool viewImage;
    private bool viewCamera;
    DateTime date;
    string blockName;
    string semesterName;
    List<(string, DateTime)> daysOfWeek = new List<(string, DateTime)>();
    List<ShiftOfCabinVM> listShift;
    List<ShiftOfCabinFullVM> listFullShift;
    //List<ClassUPViewModel> listSubClass;
    List<TeachingScheduleVM> listSchedule;
    List<BookingCabinVM> listBookingCabin;

    protected ConfirmCheckInCamera Confirmclose { get; set; }

    public Guid IdClassForDetails = Guid.Empty;
    public Guid IdSubjectForDetails = Guid.Empty;
    public Guid IdLecturerForDetails = Guid.Empty;
    public Guid IdShiftForDetails = Guid.Empty;
    public Guid? IdCabinForDetails = null;
    public string ClassSubjectNameForDetails;
    public string LecturerNameForDetails;
    public string ShiftNameForDetails;
    public string CabinNameForDetails;
    public DateTime TeachingDayForDetails;
    public TimeSpan StartShiftForDetails;
    public TimeSpan EndShiftForDetails;


    protected override async Task OnInitializedAsync()
    {
        try
        {
            idUser = _cryptoServices.Decrypt(idUserNonDecrypt.Replace("cabin","/"));
            try
            {
                string url = "http://localhost:5001/SignalRCabinHub";
                HubConnection _connection = null;
                bool isConnected = false;
                string connectionStatus = "Closed";
                _connection = new HubConnectionBuilder()
                    .WithUrl(url)
                    .Build();

                await _connection.StartAsync();
                isConnected = true;
                connectionStatus = "Connected :-)";

                _connection.Closed += async (s) =>
                {
                    isConnected = false;
                    connectionStatus = "Disconnected";
                    await _connection.StartAsync();
                    isConnected = true;
                };

                _connection.On<string>("SignalRCabins", async (res) =>
                {
                    if (res == "Done")
                    {
                        await OnInitializedAsync();

                        await this.InvokeAsync(() => this.StateHasChanged());
                    }
                });

                _connection.On<string>("SignalRGroupCabins", async (res) =>
                {
                    if (res == "Done")
                    {
                        await OnInitializedAsync();

                        await this.InvokeAsync(() => this.StateHasChanged());
                    }
                });

                _connection.On<string>("SignalRBookingCabins", async (res) =>
                {
                    if (res == "Done")
                    {
                        await OnInitializedAsync();

                        await this.InvokeAsync(() => this.StateHasChanged());
                    }
                });

                _connection.On<string>("SignalRTeachingSchedules", async (res) =>
                {
                    if (res == "Done")
                    {
                        await OnInitializedAsync();

                        await this.InvokeAsync(() => this.StateHasChanged());
                    }
                });

                _connection.On<string>("SignalRSemesterBlocks", async (res) =>
                {
                    if (res == "Done")
                    {
                        await OnInitializedAsync();

                        await this.InvokeAsync(() => this.StateHasChanged());
                    }
                });
            }
            catch (Exception ex)
            {

            }
            finally
            {
                //listSubClass = await subjectClassRepo.GetAllClass();
                //listSubClass = listSubClass.Where(c => c.HomeroomLecturerId == Guid.Parse(idUser)).ToList();

                listSchedule = await teachingScheduleApiClient.GetAll();
                listSchedule = listSchedule == null ? new List<TeachingScheduleVM>() : listSchedule.Where(c => c.Status == 0 && c.IdLecturter == Guid.Parse(idUser)).ToList();

                var listBlock = await blockRepo.GetAll();
                var listSemester = await semesterRepo.GetAll();

                date = DateTime.Now;
                blockName = listBlock.FirstOrDefault(c => c.Status == 0 && c.Id == listSchedule.FirstOrDefault(c => c.Status == 0).IdBlock).NameOfBlock;
                semesterName = listSemester.FirstOrDefault(c => c.Status == 0 && c.Id == listSchedule.FirstOrDefault(c => c.Status == 0).IdSemester).NameofSemester;
                LoadDaysOfWeek(date);

                listShift = await shiftOfCabinApiClient.GetAll();
                listShift = listShift == null ? new List<ShiftOfCabinVM>() : listShift.Where(c => c.Status != 1).ToList();

                listFullShift = await shiftOfCabinApiClient.GetAllInformationOfShiftOfCabin();
                listFullShift = listFullShift == null ? new List<ShiftOfCabinFullVM>() : listFullShift.Where(c => c.IdLecturer == Guid.Parse(idUser)).ToList();

                listBookingCabin = await _bookingCabinApiClient.GetAll();
                listBookingCabin = listBookingCabin.Where(c => c.Status != 1).ToList();
            }
        }
        catch
        {
            // Lịch học rỗng
            listSchedule = new List<TeachingScheduleVM>();
            listShift = new List<ShiftOfCabinVM>();
            listFullShift = new List<ShiftOfCabinFullVM>();
        }
    }

    private async Task Submit()
    {
        if (image == "")
        {
            _toastService.ShowError("Bạn chưa chụp ảnh");
        }
        else
        {
            close = "none";
            byteimage = Encoding.ASCII.GetBytes(image);//Chuyển image -> byte
            await StoreInDatabase(byteimage);
        }
    }


    private async Task StoreInDatabase(byte[] imageBytes)//lưu ảnh dạng byte vào database
    {
        //Thời gian chụp = DateTime.Now
        //var imageByte = Encoding.ASCII.GetString(imageBytes);
        var listBookingCabin = await _bookingCabinApiClient.GetAll();
        var objForUpdate = listBookingCabin.FirstOrDefault(c => c.Status == 0 && c.SubjectId == IdSubjectForDetails && c.ClassId == IdClassForDetails && c.IdShift == IdShiftForDetails && c.IdLectuter == IdLecturerForDetails && c.IdCabin == IdCabinForDetails && c.DateCreated == new DateTime(TeachingDayForDetails.Year, TeachingDayForDetails.Month, TeachingDayForDetails.Day));
        var obj = new BookingCabinUpdateVM()
            {
                SubjectId = IdSubjectForDetails,
                ClassId = IdClassForDetails,
                IdCabin = Guid.Parse(IdCabinForDetails.ToString()),
                IdShift = IdShiftForDetails,
                IdLectuter = IdLecturerForDetails,
                CheckinImage = imageBytes,
                CheckinTime = DateTime.Now,
                CheckoutTime = objForUpdate.CheckoutTime,
                DateCreated = objForUpdate.DateCreated,
                Note = "Checkin vào cabin",
                Status = 0
            };

        var res = await _bookingCabinApiClient.Update(objForUpdate.Id, Guid.Parse(IdCabinForDetails.ToString()), IdSubjectForDetails, IdClassForDetails, IdShiftForDetails, obj);

        if (res)
        {
            await Swal.FireAsync("Check In", "Check In Thành Công", SweetAlertIcon.Success);
        }
        else
        {
            await Swal.FireAsync("Check In", "Check In Thất Bại", SweetAlertIcon.Error);
        }
        await OnInitializedAsync();
    }
    public async Task Capture()
    {
        viewImage = false;//hiện ảnh
        viewCamera = true;//ẩn camera
        image = await JSRuntime.InvokeAsync<string>("take_snapshot_cabin");//đẩy ảnh vừa chụp
        await StopCamera();
    }
    private async Task ComeBack()
    {
        viewImage = true;//Đổi trạng thái khi ấn chụp ảnh
        viewCamera = false;
        image = "";
        await LoadCamera();
    }

    private async Task OpenCamera()//bật tắt tab chụp ảnh
    {
        try
        {
            viewImage = true;//Đổi trạng thái khi ấn chụp ảnh
            viewCamera = false;
            loadCamera = true;
            close = "block";
            await LoadCamera();
        }
        catch(Exception ex)
        {
            await OnConfirmationClose(true);
            _toastService.ShowError("Có lỗi xảy ra khi bật camera. Vui lòng kiểm tra và thử lại");
        }

    }

    public async Task ViewBookingRequest()
    {
        await bookingRequestForLecturer.show();
    }

    public async Task BookARoom(ShiftOfCabinFullVM obj)
    {
        /*
        * obj = null -> Mở ExchangeTeachingSchedule
        * So sánh DateTime.Now với khoảng ca, thứ
        * Trong khoảng -> Mở CheckIn
        * Ngoài khoảng -> Mở DetailShift
        *
        */
        // DetailShift (Booking)
        IdClassForDetails = Guid.Parse(obj.IdClass.ToString());
        IdSubjectForDetails = Guid.Parse(obj.IdSubject.ToString());
        IdLecturerForDetails = Guid.Parse(obj.IdLecturer.ToString());
        IdShiftForDetails = Guid.Parse(obj.IdShiftOfCabin.ToString());
        IdCabinForDetails = obj.IdCabin == null ? null : Guid.Parse(obj.IdCabin.ToString());
        ClassSubjectNameForDetails = obj.ClassName + " - " + obj.SubjectCode;
        LecturerNameForDetails = obj.LecturerUserName;
        ShiftNameForDetails = obj.ShiftName;
        CabinNameForDetails = obj.CabinName;
        TeachingDayForDetails = obj.TeachingDay.Value;
        StartShiftForDetails = obj.StartTimeOfShift.Value;
        EndShiftForDetails = obj.EndTimeOfShift.Value;

        if (obj == null)
        {
            // ExchangeTeachingSchedule
        }
        else
        {
            DateTime startTime = new DateTime(obj.TeachingDay.Value.Year, obj.TeachingDay.Value.Month, obj.TeachingDay.Value.Day, obj.StartTimeOfShift.Value.Hours, obj.StartTimeOfShift.Value.Minutes, obj.StartTimeOfShift.Value.Seconds);
            DateTime endTime = new DateTime(obj.TeachingDay.Value.Year, obj.TeachingDay.Value.Month, obj.TeachingDay.Value.Day, obj.EndTimeOfShift.Value.Hours, obj.EndTimeOfShift.Value.Minutes, obj.EndTimeOfShift.Value.Seconds);
            var objForUpdate = listBookingCabin.FirstOrDefault(c => c.Status == 0 && c.SubjectId == IdSubjectForDetails && c.ClassId == IdClassForDetails && c.IdShift == IdShiftForDetails && c.IdLectuter == IdLecturerForDetails && c.IdCabin == IdCabinForDetails && c.DateCreated == new DateTime(TeachingDayForDetails.Year, TeachingDayForDetails.Month, TeachingDayForDetails.Day));

            if (DateTime.Now >= startTime && DateTime.Now < endTime && IdCabinForDetails != null && objForUpdate.CheckinImage == null)
            {
                // CheckIn
                await OpenCamera();
            }
            else
            {
                await bookingCabin.show();
            }
        }
    }
    private async Task Close()//Thoát chụp ảnh
    {
        Confirmclose.show();
    }

    private async Task LoadCamera()
    {
        image = "";
        await JSRuntime.InvokeVoidAsync("ready_cabin", this);//Bật camera
        TimeLoad();

    }

    private async Task StopCamera()//tắt camera
    {
        await JSRuntime.InvokeVoidAsync("stop_cabin", this);
    }

    private void TimeLoad()
    {
        Stopwatch stopwatch = new Stopwatch();
        stopwatch.Start();
        Thread.Sleep(700);//Cho camera load 0.7s
        stopwatch.Stop();
        loadCamera = false;
    }
    public async Task OnConfirmationClose(bool deleteconfirmed)//xác nhận thoát tab chụp ảnh
    {
        if (deleteconfirmed)
        {
            close = "none";
            await StopCamera();
        }
    }

    private async Task OnConfirmationBooking(int result)
    {
        if (result == 1)
        {
            await Swal.FireAsync("Xếp Phòng", "Xếp Phòng Cho Lớp Học Thành Công", SweetAlertIcon.Success);
        }
        if (result == 2)
        {
            await Swal.FireAsync("Xếp Phòng", "Xếp Phòng Cho Lớp Học Thất Bại", SweetAlertIcon.Error);
        }

        await OnInitializedAsync();
    }

    #region Load DaysOfWeek
    public void LoadDaysOfWeek(DateTime date)
    {
        date = new DateTime(date.Year, date.Month, date.Day);
        daysOfWeek = new List<(string, DateTime)>();

        var dayOfWeek = date.DayOfWeek;
        DateTime monday = new DateTime();
        if (dayOfWeek == DayOfWeek.Sunday)
        {
            //xét chủ nhật là đầu tuần
            //return date.AddDays(1);

            //xét chủ nhật là ngày cuối tuần
            monday = date.AddDays(-6);
        }
        else
        {
            int offset = dayOfWeek - DayOfWeek.Monday;
            monday = date.AddDays(-offset);
        }
        daysOfWeek.Add(new("Thứ 2", monday));
        for (int i = 1; i < 7; i++)
        {
            if (i == 6)
            {
                daysOfWeek.Add(new($"Chủ Nhật", monday.AddDays(i)));
            }
            else
            {
                daysOfWeek.Add(new($"Thứ {i + 2}", monday.AddDays(i)));
            }
        }
    }

    #endregion


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private SweetAlertService Swal { get; set; }
    }
}
#pragma warning restore 1591
